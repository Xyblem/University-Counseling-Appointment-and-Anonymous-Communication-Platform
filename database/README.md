

---
# 用户表(user)数据字典

## 表基本信息

| 属性 | 值 |
|------|-----|
| **表名** | user |
| **存储引擎** | InnoDB |
| **字符集** | utf8mb4 |
| **排序规则** | utf8mb4_0900_ai_ci |
| **表注释** | 用户表（用于注册和登录） |

## 字段说明

### 主键字段
| 字段名 | 数据类型 | 是否为空 | 默认值 | 字段注释 | 约束条件 |
|--------|----------|----------|---------|----------|----------|
| username | VARCHAR(45) | NOT NULL | - | 用户名（账号名） | 主键，唯一约束，长度8-45字符，只能包含字母、数字和下划线 |

### 基本信息字段
| 字段名 | 数据类型 | 是否为空 | 默认值 | 字段注释 | 约束条件 |
|--------|----------|----------|---------|----------|----------|
| nickname | VARCHAR(45) | NULL | NULL | 昵称 | 长度8-45个字符 |
| description | VARCHAR(255) | NULL | NULL | 描述 | 用户描述信息 |
| name | VARCHAR(6) | NOT NULL | - | 姓名（个人真实姓名） | 长度2-6个字符，只能包含汉字 |
| password | VARCHAR(45) | NOT NULL | - | 密码 | 长度8-45个字符，只能包含字母、数字、!和? |

### 个人属性字段
| 字段名 | 数据类型 | 是否为空 | 默认值 | 字段注释 | 约束条件 |
|--------|----------|----------|---------|----------|----------|
| gender | TINYINT | NOT NULL | - | 性别 | 国家性别编码：0未知，1男性，2女性，9未指定(其他) |
| school_province | BIGINT(20) | NOT NULL | - | 学校所在省份 | 行政区编码，符合GB/T2260-2007标准 |
| school | VARCHAR(60) | NOT NULL | - | 所属学校 | 长度4-60个字符 |
| secondary_unit | VARCHAR(100) | NOT NULL | - | 二级单位 | 长度2-100个字符 |
| major | VARCHAR(45) | NULL | NULL | 专业 | 长度2-45个字符 |
| role | TINYINT | NOT NULL | - | 用户类型 | 用户类型编码：0未知，1学生，2教师，3管理员，9未指定 |
| position | VARCHAR(20) | NOT NULL | - | 职务 | 只能是：未指定、学生、心理部咨询员、心理部负责人、非心理部教职工 |

### 联系方式字段
| 字段名 | 数据类型 | 是否为空 | 默认值 | 字段注释 | 约束条件 |
|--------|----------|----------|---------|----------|----------|
| email | VARCHAR(255) | NOT NULL | - | 邮箱 | 符合邮箱格式，最多255个字符 |
| phone_number | VARCHAR(20) | NOT NULL | - | 电话号码 | 符合电话号码格式，长度20个字符 |
| qq | VARCHAR(20) | NULL | NULL | QQ账号 | 长度6-20个字符 |
| wechat | VARCHAR(45) | NULL | NULL | 微信账号 | 长度6-20个字符 |

### 系统字段
| 字段名 | 数据类型 | 是否为空 | 默认值 | 字段注释 | 约束条件 |
|--------|----------|----------|---------|----------|----------|
| registration_time | DATETIME | NOT NULL | NOW() | 注册时间 | 用户注册时间 |

## 约束说明

### 主键约束
- **PRIMARY KEY (username)**: 用户名为主键

### 唯一约束
- **username_UNIQUE (username)**: 用户名必须唯一

### 检查约束

#### 用户名约束 (chk_username)
- 用户名长度为8-45个字符
- 只能包含字母、数字和下划线

#### 姓名约束 (chk_name)
- 姓名长度为2-6个字符
- 只能包含《通用规范汉字表》中汉字

#### 密码约束 (chk_password)
- 密码长度为8-45个字符
- 只能包含字母、数字、英文感叹号(!)和英文问号(?)

#### 性别约束 (chk_gender)
- 使用国家性别编码标准
- 有效值：0(未知), 1(男性), 2(女性), 9(未指定/其他)

#### 省份约束 (chk_school_province)
- 使用中华人民共和国行政区划代码
- 符合GB/T2260-2007国家标准

#### 学校约束 (chk_school)
- 学校名称长度至少4个字符

#### 二级单位约束 (chk_secondary_unit)
- 二级单位名称长度至少2个字符

#### 专业约束 (chk_major)
- 专业名称长度至少2个字符

#### 用户类型约束 (chk_identity)
- 用户类型编码：0(未知), 1(学生), 2(心理咨询教师), 3(学校心理中心管理员), 9(未指定/其他)

#### 职务约束 (chk_position)
- 有效职务：'未指定', '学生', '心理部咨询员', '心理部负责人', '非心理部教职工'

#### 邮箱约束 (chk_email)
- 符合标准邮箱格式
- 支持中文邮箱地址

#### 电话号码约束 (chk_phone_number)
- 符合中国电话号码格式
- 支持手机号、固定电话及带分机号码

#### QQ账号约束 (chk_qq)
- QQ账号长度6-20个字符

#### 微信账号约束 (chk_wechat)
- 微信账号长度6-20个字符

## 编码标准参考

1. **姓名登记条例** - 姓名格式标准
2. **GB 2261-1980** - 人的性别代码国家标准
3. **GB/T2260-2007** - 中华人民共和国行政区划代码
4. **项目规范** - 2022级软件工程+软件工程综合实践+项目选题

## 业务规则

1. 所有用户必须使用唯一用户名注册
2. 注册时间由系统自动生成
3. 用户类型和职务有明确的业务含义区分
4. 联系信息有严格的格式验证
5. 个人真实信息需符合国家相关标准规范